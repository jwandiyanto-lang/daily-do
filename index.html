<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0E121A">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="description" content="Your personal AI-powered finance manager">
  <title>Finance App</title>

  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="stylesheet" href="styles/app.css">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: #0E121A;
      min-height: 100vh;
      color: #fff;
      padding: 20px;
      padding-bottom: 100px;
      transition: background 0.3s, color 0.3s;
    }

    body.light-theme { background: #F5F5F7; color: #1a1a1a; }
    body.light-theme .balance-card { background: linear-gradient(135deg, #F7C846 0%, #ff9500 100%); }
    body.light-theme .stat-card { background: #fff; border-color: rgba(0,0,0,0.1); }
    body.light-theme .stat-label { color: #666; }
    body.light-theme .quick-action { background: #fff; border-color: rgba(0,0,0,0.1); }
    body.light-theme .quick-action span:last-child { color: #666; }
    body.light-theme .tip-card { background: #fff; border-color: rgba(0,0,0,0.1); }
    body.light-theme .tip-text { color: #666; }

    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: rgba(255,255,255,0.1);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      transition: all 0.3s;
    }
    .theme-toggle:hover { background: rgba(255,255,255,0.2); }
    body.light-theme .theme-toggle { background: rgba(0,0,0,0.08); }

    .header { text-align: center; padding: 40px 0 30px; }
    .greeting { color: #888; font-size: 0.9rem; margin-bottom: 8px; }
    .app-title { font-size: 2rem; font-weight: 800; }
    .app-title span { color: #F7C846; }

    .balance-card {
      background: linear-gradient(135deg, #1a2a1a 0%, #0E121A 100%);
      border-radius: 20px;
      padding: 28px;
      margin-bottom: 20px;
      text-align: center;
      border: 1px solid rgba(138,233,141,0.2);
    }
    .balance-label { font-size: 0.85rem; color: #888; margin-bottom: 8px; }
    .balance-amount { font-size: 2.5rem; font-weight: 800; color: #8AE98D; }
    .balance-trend { margin-top: 8px; font-size: 0.85rem; color: #8AE98D; }

    .stats-row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 14px;
      padding: 16px;
    }
    .stat-label { font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px; }
    .stat-value { font-size: 1.3rem; font-weight: 700; }
    .stat-value.green { color: #8AE98D; }
    .stat-value.red { color: #E74C3C; }
    .stat-value.yellow { color: #F7C846; }

    .section-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
    }

    .quick-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 24px;
    }

    .quick-action {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 14px;
      text-decoration: none;
      color: inherit;
      transition: all 0.2s;
    }
    .quick-action:hover { border-color: rgba(255,255,255,0.2); transform: translateX(4px); }
    .quick-action .icon { font-size: 1.5rem; }
    .quick-action .text { flex: 1; }
    .quick-action .title { font-weight: 600; font-size: 1rem; margin-bottom: 2px; }
    .quick-action .desc { font-size: 0.8rem; color: #888; }
    .quick-action .arrow { color: #888; font-size: 1.2rem; }

    .tip-card {
      background: rgba(247,200,70,0.1);
      border: 1px solid rgba(247,200,70,0.2);
      border-radius: 14px;
      padding: 16px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    .tip-icon { font-size: 1.3rem; }
    .tip-content { flex: 1; }
    .tip-title { font-weight: 600; font-size: 0.9rem; margin-bottom: 4px; color: #F7C846; }
    .tip-text { font-size: 0.85rem; color: #aaa; line-height: 1.4; }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #0E121A;
      border-top: 1px solid rgba(255,255,255,0.1);
      padding: 8px 0 20px;
      z-index: 50;
    }
    body.light-theme .bottom-nav { background: #fff; border-color: rgba(0,0,0,0.1); }

    .nav-items {
      display: flex;
      justify-content: space-around;
      list-style: none;
      max-width: 500px;
      margin: 0 auto;
    }
    .nav-link {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-decoration: none;
      color: #888;
      padding: 8px 16px;
    }
    .nav-link.active { color: #F7C846; }
    .nav-icon { font-size: 1.3rem; margin-bottom: 4px; }
    .nav-label { font-size: 0.7rem; }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">üåô</button>

  <div class="header">
    <p class="greeting" id="greeting">Good morning</p>
    <h1 class="app-title">My <span>Finance</span></h1>
  </div>

  <!-- Balance Card -->
  <div class="balance-card">
    <div class="balance-label">Current Balance</div>
    <div class="balance-amount" id="balance">0</div>
    <div class="balance-trend" id="trend"></div>
  </div>

  <!-- Stats -->
  <div class="stats-row">
    <div class="stat-card">
      <div class="stat-label">Income</div>
      <div class="stat-value green" id="income">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Expenses</div>
      <div class="stat-value red" id="expenses">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Funds Saved</div>
      <div class="stat-value yellow" id="fundsSaved">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Active Funds</div>
      <div class="stat-value" id="fundsCount">0</div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="section-title">Quick Actions</div>
  <div class="quick-actions">
    <a href="finance/summary.html" class="quick-action">
      <span class="icon">üí∏</span>
      <div class="text">
        <div class="title">Add Transaction</div>
        <div class="desc">Record income or expense</div>
      </div>
      <span class="arrow">‚Üí</span>
    </a>
    <a href="finance/summary.html#funds" class="quick-action" onclick="localStorage.setItem('openTab', 'funds')">
      <span class="icon">üéØ</span>
      <div class="text">
        <div class="title">Manage Funds</div>
        <div class="desc">Track your savings goals</div>
      </div>
      <span class="arrow">‚Üí</span>
    </a>
    <a href="finance/summary.html#advisor" class="quick-action" onclick="localStorage.setItem('openTab', 'advisor')">
      <span class="icon">ü§ñ</span>
      <div class="text">
        <div class="title">AI Financial Advisor</div>
        <div class="desc">Get personalized guidance</div>
      </div>
      <span class="arrow">‚Üí</span>
    </a>
  </div>

  <!-- Tip -->
  <div class="tip-card" id="tipCard">
    <span class="tip-icon">üí°</span>
    <div class="tip-content">
      <div class="tip-title">Financial Tip</div>
      <div class="tip-text" id="tipText">Start by tracking all your expenses for a week to understand your spending patterns.</div>
    </div>
  </div>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <ul class="nav-items">
      <li><a href="index.html" class="nav-link active"><span class="nav-icon">üè†</span><span class="nav-label">Home</span></a></li>
      <li><a href="finance/summary.html" class="nav-link"><span class="nav-icon">üí∞</span><span class="nav-label">Finance</span></a></li>
    </ul>
  </nav>

  <script src="scripts/memory.js"></script>
  <script>
    // Set greeting based on time
    function setGreeting() {
      const hour = new Date().getHours();
      let greeting = 'Good evening';
      if (hour < 12) greeting = 'Good morning';
      else if (hour < 18) greeting = 'Good afternoon';
      document.getElementById('greeting').textContent = greeting;
    }
    setGreeting();

    // Theme toggle
    function toggleTheme() {
      const body = document.body;
      const btn = document.getElementById('themeToggle');
      const isLight = body.classList.toggle('light-theme');
      btn.textContent = isLight ? '‚òÄÔ∏è' : 'üåô';
      Memory.set('settings', 'theme', isLight ? 'light' : 'dark');
    }

    function loadTheme() {
      const savedTheme = Memory.get('settings', 'theme');
      if (savedTheme === 'light') {
        document.body.classList.add('light-theme');
        document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
      }
    }
    loadTheme();

    // Format currency
    function formatCurrency(amount) {
      return new Intl.NumberFormat('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(amount);
    }

    // Load financial data
    function loadFinancialData() {
      const transactions = Memory.get('finance', 'transactions') || [];
      const funds = Memory.get('finance', 'funds') || [];

      let income = 0, expense = 0;
      transactions.forEach(t => {
        if (t.type === 'income') income += t.amount;
        else expense += t.amount;
      });

      const balance = income - expense;
      const fundsSaved = funds.reduce((sum, f) => sum + (f.current || 0), 0);

      document.getElementById('balance').textContent = formatCurrency(balance);
      document.getElementById('income').textContent = formatCurrency(income);
      document.getElementById('expenses').textContent = formatCurrency(expense);
      document.getElementById('fundsSaved').textContent = formatCurrency(fundsSaved);
      document.getElementById('fundsCount').textContent = funds.length;

      // Set trend
      const trend = document.getElementById('trend');
      if (transactions.length === 0) {
        trend.textContent = 'Start tracking to see trends';
        trend.style.color = '#888';
      } else if (balance > 0) {
        trend.textContent = '‚Üë You\'re in the green!';
        trend.style.color = '#8AE98D';
      } else if (balance < 0) {
        trend.textContent = '‚Üì Spending exceeds income';
        trend.style.color = '#E74C3C';
      } else {
        trend.textContent = 'Breaking even';
        trend.style.color = '#F7C846';
      }
    }
    loadFinancialData();

    // Random financial tips
    const tips = [
      'Start by tracking all your expenses for a week to understand your spending patterns.',
      'Aim to save at least 20% of your income each month.',
      'Build an emergency fund that covers 3-6 months of expenses.',
      'Review your subscriptions monthly - cancel what you don\'t use.',
      'Pay yourself first: set aside savings before spending.',
      'Use the 50/30/20 rule: 50% needs, 30% wants, 20% savings.',
      'Automate your savings to make it effortless.',
      'Track your net worth monthly to see your progress.',
      'Avoid lifestyle inflation when your income increases.',
      'Start investing early - compound interest is powerful.'
    ];
    document.getElementById('tipText').textContent = tips[Math.floor(Math.random() * tips.length)];

    // Register Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js');
    }
  </script>
</body>
</html>
